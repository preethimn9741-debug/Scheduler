import time
import json
import subprocess
import logging
import os


logging.basicConfig(
    filename="scheduler.log",
    level=logging.INFO,
    format="%(asctime)s - %(levelname)s - %(message)s"
)

with open("jobs.json", "r") as f:
    jobs = json.load(f)

# Add last_run time to each job
for job in jobs:
    job["last_run"] = 0

print("Scheduler started... Press CTRL+C to stop")

try:
    while True:
        current_time = time.time()

        for job in jobs:
            if current_time - job["last_run"] >= job["interval"]:
                logging.info(f"Running job: {job['name']}")

                try:
                    result = subprocess.run(
                        ["python", job["script"]],
                        capture_output=True,
                        text=True
                    )

                    if result.returncode == 0:
                        logging.info(f"{job['name']} completed successfully")
                    else:
                        logging.error(f"{job['name']} failed: {result.stderr}")

                except Exception as e:
                    logging.error(f"{job['name']} error: {str(e)}")

                job["last_run"] = current_time

        time.sleep(1)

except KeyboardInterrupt:
    print("\nScheduler stopped gracefully")
    logging.info("Scheduler stopped by user")
2025-12-19 12:54:39,820 - INFO - Running job: Job 1
2025-12-19 12:54:39,913 - INFO - Job 1 completed successfully
2025-12-19 12:54:44,373 - INFO - Scheduler stopped by user
2025-12-19 12:55:08,125 - INFO - Running job: Job 1
2025-12-19 12:55:08,176 - INFO - Job 1 completed successfully
2025-12-19 12:55:13,180 - INFO - Running job: Job 1
2025-12-19 12:55:13,233 - INFO - Job 1 completed successfully
2025-12-19 12:55:18,237 - INFO - Running job: Job 1
2025-12-19 12:55:18,310 - INFO - Job 1 completed successfully
2025-12-19 12:55:23,313 - INFO - Running job: Job 1
2025-12-19 12:55:23,393 - INFO - Job 1 completed successfully
2025-12-19 12:55:28,397 - INFO - Running job: Job 1
2025-12-19 12:55:28,437 - INFO - Job 1 completed successfully
2025-12-19 12:55:33,441 - INFO - Running job: Job 1
2025-12-19 12:55:33,491 - INFO - Job 1 completed successfully
2025-12-19 12:55:38,494 - INFO - Running job: Job 1
2025-12-19 12:55:38,548 - INFO - Job 1 completed successfully
2025-12-19 12:55:43,551 - INFO - Running job: Job 1
2025-12-19 12:55:43,605 - INFO - Job 1 completed successfully
2025-12-19 12:55:48,609 - INFO - Running job: Job 1
2025-12-19 12:55:48,666 - INFO - Job 1 completed successfully
2025-12-19 12:55:53,669 - INFO - Running job: Job 1
2025-12-19 12:55:53,732 - INFO - Job 1 completed successfully
2025-12-19 12:55:58,735 - INFO - Running job: Job 1
2025-12-19 12:55:58,783 - INFO - Job 1 completed successfully
2025-12-19 12:56:03,786 - INFO - Running job: Job 1
2025-12-19 12:56:03,988 - INFO - Job 1 completed successfully
2025-12-19 12:56:08,991 - INFO - Running job: Job 1
2025-12-19 12:56:09,050 - INFO - Job 1 completed successfully
2025-12-19 12:56:14,053 - INFO - Running job: Job 1
2025-12-19 12:56:14,119 - INFO - Job 1 completed successfully
2025-12-19 12:56:19,122 - INFO - Running job: Job 1
2025-12-19 12:56:19,174 - INFO - Job 1 completed successfully
2025-12-19 12:56:24,178 - INFO - Running job: Job 1
2025-12-19 12:56:24,234 - INFO - Job 1 completed successfully
2025-12-19 12:56:29,237 - INFO - Running job: Job 1
2025-12-19 12:56:29,391 - INFO - Job 1 completed successfully
2025-12-19 12:56:34,393 - INFO - Running job: Job 1
2025-12-19 12:56:34,446 - INFO - Job 1 completed successfully
2025-12-19 12:56:39,448 - INFO - Running job: Job 1
2025-12-19 12:56:39,535 - INFO - Job 1 completed successfully
2025-12-19 12:56:44,538 - INFO - Running job: Job 1
2025-12-19 12:56:44,611 - INFO - Job 1 completed successfully
2025-12-19 12:56:44,893 - INFO - Scheduler stopped by user
2025-12-19 12:56:55,017 - INFO - Running job: Job 1
2025-12-19 12:56:55,067 - INFO - Job 1 completed successfully
2025-12-19 12:57:00,070 - INFO - Running job: Job 1
2025-12-19 12:57:00,148 - INFO - Job 1 completed successfully
2025-12-19 12:57:05,152 - INFO - Running job: Job 1
2025-12-19 12:57:05,224 - INFO - Job 1 completed successfully
2025-12-19 12:57:10,227 - INFO - Running job: Job 1
2025-12-19 12:57:10,296 - INFO - Job 1 completed successfully
2025-12-19 12:57:15,300 - INFO - Running job: Job 1
2025-12-19 12:57:15,415 - INFO - Job 1 completed successfully
2025-12-19 12:57:20,418 - INFO - Running job: Job 1
2025-12-19 12:57:20,491 - INFO - Job 1 completed successfully
2025-12-19 12:57:25,494 - INFO - Running job: Job 1
2025-12-19 12:57:25,580 - INFO - Job 1 completed successfully
2025-12-19 12:57:30,583 - INFO - Running job: Job 1
2025-12-19 12:57:30,670 - INFO - Job 1 completed successfully
2025-12-19 12:57:35,674 - INFO - Running job: Job 1
2025-12-19 12:57:35,729 - INFO - Job 1 completed successfully
2025-12-19 12:57:40,732 - INFO - Running job: Job 1
2025-12-19 12:57:40,814 - INFO - Job 1 completed successfully
2025-12-19 12:57:45,817 - INFO - Running job: Job 1
2025-12-19 12:57:45,893 - INFO - Job 1 completed successfully
2025-12-19 12:57:47,281 - INFO - Scheduler stopped by user
2025-12-19 13:01:00,967 - INFO - Running job: Job 1
2025-12-19 13:01:01,027 - INFO - Job 1 completed successfully
2025-12-19 13:01:06,030 - INFO - Running job: Job 1
2025-12-19 13:01:06,075 - INFO - Job 1 completed successfully
2025-12-19 13:01:11,078 - INFO - Running job: Job 1
2025-12-19 13:01:11,120 - INFO - Job 1 completed successfully
2025-12-19 13:01:16,122 - INFO - Running job: Job 1
2025-12-19 13:01:16,198 - INFO - Job 1 completed successfully
2025-12-19 13:01:21,202 - INFO - Running job: Job 1
2025-12-19 13:01:21,279 - INFO - Job 1 completed successfully
2025-12-19 13:01:26,282 - INFO - Running job: Job 1
2025-12-19 13:01:26,355 - INFO - Job 1 completed successfully
2025-12-19 13:01:31,358 - INFO - Running job: Job 1
2025-12-19 13:01:31,436 - INFO - Job 1 completed successfully
2025-12-19 13:01:36,440 - INFO - Running job: Job 1
2025-12-19 13:01:36,532 - INFO - Job 1 completed successfully
2025-12-19 13:01:41,536 - INFO - Running job: Job 1
2025-12-19 13:01:41,639 - INFO - Job 1 completed successfully
2025-12-19 13:01:46,643 - INFO - Running job: Job 1
2025-12-19 13:01:46,727 - INFO - Job 1 completed successfully
2025-12-19 13:01:51,731 - INFO - Running job: Job 1
2025-12-19 13:01:51,812 - INFO - Job 1 completed successfully
2025-12-19 13:01:56,815 - INFO - Running job: Job 1
2025-12-19 13:01:56,880 - INFO - Job 1 completed successfully
2025-12-19 13:02:01,883 - INFO - Running job: Job 1
2025-12-19 13:02:01,969 - INFO - Job 1 completed successfully
2025-12-19 13:02:06,972 - INFO - Running job: Job 1
2025-12-19 13:02:07,030 - INFO - Job 1 completed successfully
2025-12-19 13:02:12,033 - INFO - Running job: Job 1
2025-12-19 13:02:12,151 - INFO - Job 1 completed successfully
2025-12-19 13:02:17,154 - INFO - Running job: Job 1
2025-12-19 13:02:17,236 - INFO - Job 1 completed successfully
2025-12-19 13:02:22,239 - INFO - Running job: Job 1
2025-12-19 13:02:22,297 - INFO - Job 1 completed successfully
2025-12-19 13:02:25,777 - INFO - Scheduler stopped by user
2025-12-19 13:02:56,462 - INFO - Running job: Job 1
2025-12-19 13:02:56,548 - INFO - Job 1 completed successfully
2025-12-19 13:03:01,552 - INFO - Running job: Job 1
2025-12-19 13:03:01,605 - INFO - Job 1 completed successfully
2025-12-19 13:03:06,608 - INFO - Running job: Job 1
2025-12-19 13:03:06,679 - INFO - Job 1 completed successfully
2025-12-19 13:03:11,683 - INFO - Running job: Job 1
2025-12-19 13:03:11,775 - INFO - Job 1 completed successfully
2025-12-19 13:03:16,778 - INFO - Running job: Job 1
2025-12-19 13:03:16,844 - INFO - Job 1 completed successfully
2025-12-19 13:03:21,847 - INFO - Running job: Job 1
2025-12-19 13:03:21,921 - INFO - Job 1 completed successfully
2025-12-19 13:03:26,924 - INFO - Running job: Job 1
2025-12-19 13:03:27,009 - INFO - Job 1 completed successfully
2025-12-19 13:03:32,013 - INFO - Running job: Job 1
2025-12-19 13:03:32,085 - INFO - Job 1 completed successfully
2025-12-19 13:03:37,089 - INFO - Running job: Job 1
2025-12-19 13:03:37,174 - INFO - Job 1 completed successfully
2025-12-19 13:03:42,177 - INFO - Running job: Job 1
2025-12-19 13:03:42,252 - INFO - Job 1 completed successfully
2025-12-19 13:03:47,255 - INFO - Running job: Job 1
2025-12-19 13:03:47,307 - INFO - Job 1 completed successfully
2025-12-19 13:03:52,310 - INFO - Running job: Job 1
2025-12-19 13:03:52,368 - INFO - Job 1 completed successfully
2025-12-19 13:03:57,372 - INFO - Running job: Job 1
2025-12-19 13:03:57,424 - INFO - Job 1 completed successfully
2025-12-19 13:04:02,429 - INFO - Running job: Job 1
2025-12-19 13:04:02,470 - INFO - Job 1 completed successfully
2025-12-19 13:04:07,474 - INFO - Running job: Job 1
2025-12-19 13:04:07,526 - INFO - Job 1 completed successfully
2025-12-19 13:04:12,530 - INFO - Running job: Job 1
2025-12-19 13:04:12,583 - INFO - Job 1 completed successfully
2025-12-19 13:04:17,587 - INFO - Running job: Job 1
2025-12-19 13:04:17,655 - INFO - Job 1 completed successfully
2025-12-19 13:04:22,659 - INFO - Running job: Job 1
2025-12-19 13:04:22,702 - INFO - Job 1 completed successfully
2025-12-19 13:04:27,704 - INFO - Running job: Job 1
2025-12-19 13:04:27,741 - INFO - Job 1 completed successfully
2025-12-19 13:04:32,744 - INFO - Running job: Job 1
2025-12-19 13:04:32,790 - INFO - Job 1 completed successfully
2025-12-19 13:04:37,794 - INFO - Running job: Job 1
2025-12-19 13:04:37,876 - INFO - Job 1 completed successfully
2025-12-19 13:04:42,878 - INFO - Running job: Job 1
2025-12-19 13:04:42,936 - INFO - Job 1 completed successfully
2025-12-19 13:04:47,940 - INFO - Running job: Job 1
2025-12-19 13:04:48,024 - INFO - Job 1 completed successfully
2025-12-19 13:04:53,027 - INFO - Running job: Job 1
2025-12-19 13:04:53,111 - INFO - Job 1 completed successfully
2025-12-19 13:04:58,114 - INFO - Running job: Job 1
2025-12-19 13:04:58,258 - INFO - Job 1 completed successfully
2025-12-19 13:05:03,262 - INFO - Running job: Job 1
2025-12-19 13:05:03,399 - INFO - Job 1 completed successfully
2025-12-19 13:05:08,403 - INFO - Running job: Job 1
2025-12-19 13:05:08,541 - INFO - Job 1 completed successfully
2025-12-19 13:05:13,546 - INFO - Running job: Job 1
2025-12-19 13:05:13,696 - INFO - Job 1 completed successfully
2025-12-19 13:05:18,698 - INFO - Running job: Job 1
2025-12-19 13:05:18,835 - INFO - Job 1 completed successfully
2025-12-19 13:05:23,837 - INFO - Running job: Job 1
2025-12-19 13:05:23,978 - INFO - Job 1 completed successfully
2025-12-19 13:05:28,981 - INFO - Running job: Job 1
2025-12-19 13:05:29,115 - INFO - Job 1 completed successfully
2025-12-19 13:05:34,119 - INFO - Running job: Job 1
2025-12-19 13:05:34,244 - INFO - Job 1 completed successfully
2025-12-19 13:05:39,247 - INFO - Running job: Job 1
2025-12-19 13:05:39,446 - INFO - Job 1 completed successfully
2025-12-19 13:05:44,451 - INFO - Running job: Job 1
2025-12-19 13:05:44,599 - INFO - Job 1 completed successfully
2025-12-19 13:05:49,602 - INFO - Running job: Job 1
2025-12-19 13:05:49,741 - INFO - Job 1 completed successfully
2025-12-19 13:05:54,746 - INFO - Running job: Job 1
2025-12-19 13:05:54,887 - INFO - Job 1 completed successfully
2025-12-19 13:05:59,891 - INFO - Running job: Job 1
2025-12-19 13:06:00,031 - INFO - Job 1 completed successfully
2025-12-19 13:06:05,036 - INFO - Running job: Job 1
2025-12-19 13:06:05,172 - INFO - Job 1 completed successfully
2025-12-19 13:06:10,176 - INFO - Running job: Job 1
2025-12-19 13:06:10,311 - INFO - Job 1 completed successfully
2025-12-19 13:06:15,313 - INFO - Running job: Job 1
2025-12-19 13:06:15,447 - INFO - Job 1 completed successfully
2025-12-19 13:06:20,451 - INFO - Running job: Job 1
2025-12-19 13:06:20,595 - INFO - Job 1 completed successfully
2025-12-19 13:06:25,598 - INFO - Running job: Job 1
2025-12-19 13:06:25,741 - INFO - Job 1 completed successfully
2025-12-19 13:06:30,748 - INFO - Running job: Job 1
2025-12-19 13:06:30,889 - INFO - Job 1 completed successfully
2025-12-19 13:06:35,892 - INFO - Running job: Job 1
2025-12-19 13:06:36,030 - INFO - Job 1 completed successfully
2025-12-19 13:06:41,033 - INFO - Running job: Job 1
2025-12-19 13:06:41,168 - INFO - Job 1 completed successfully
2025-12-19 13:06:46,171 - INFO - Running job: Job 1
2025-12-19 13:06:46,309 - INFO - Job 1 completed successfully
2025-12-19 13:06:51,312 - INFO - Running job: Job 1
2025-12-19 13:06:51,449 - INFO - Job 1 completed successfully
2025-12-19 13:06:56,454 - INFO - Running job: Job 1
2025-12-19 13:06:56,601 - INFO - Job 1 completed successfully
2025-12-19 13:07:01,605 - INFO - Running job: Job 1
2025-12-19 13:07:01,717 - INFO - Job 1 completed successfully
2025-12-19 13:07:06,721 - INFO - Running job: Job 1
2025-12-19 13:07:06,865 - INFO - Job 1 completed successfully
2025-12-19 13:07:12,872 - INFO - Running job: Job 1
2025-12-19 13:07:13,126 - INFO - Job 1 completed successfully
2025-12-19 14:26:37,230 - INFO - Running job: Job 1
2025-12-19 14:26:37,782 - INFO - Job 1 completed successfully
2025-12-19 14:27:49,614 - INFO - Running job: Job 1
2025-12-19 14:27:50,927 - INFO - Job 1 completed successfully
2025-12-19 14:27:54,930 - INFO - Running job: Job 1
2025-12-19 14:27:55,062 - INFO - Job 1 completed successfully
2025-12-19 14:28:00,065 - INFO - Running job: Job 1
2025-12-19 14:28:00,212 - INFO - Job 1 completed successfully
2025-12-19 14:28:05,215 - INFO - Running job: Job 1
2025-12-19 14:28:05,355 - INFO - Job 1 completed successfully
2025-12-19 14:28:10,358 - INFO - Running job: Job 1
2025-12-19 14:28:10,495 - INFO - Job 1 completed successfully
2025-12-19 14:28:15,500 - INFO - Running job: Job 1
2025-12-19 14:28:15,640 - INFO - Job 1 completed successfully
2025-12-19 14:28:20,644 - INFO - Running job: Job 1
2025-12-19 14:28:20,778 - INFO - Job 1 completed successfully
2025-12-19 14:28:25,782 - INFO - Running job: Job 1
2025-12-19 14:28:25,917 - INFO - Job 1 completed successfully
2025-12-19 14:28:30,920 - INFO - Running job: Job 1
2025-12-19 14:28:31,058 - INFO - Job 1 completed successfully
2025-12-19 14:28:36,060 - INFO - Running job: Job 1
2025-12-19 14:28:36,174 - INFO - Job 1 completed successfully
2025-12-19 14:28:41,177 - INFO - Running job: Job 1
2025-12-19 14:28:41,227 - INFO - Job 1 completed successfully
2025-12-19 14:28:46,230 - INFO - Running job: Job 1
2025-12-19 14:28:46,371 - INFO - Job 1 completed successfully
2025-12-19 14:28:51,374 - INFO - Running job: Job 1
2025-12-19 14:28:51,480 - INFO - Job 1 completed successfully
2025-12-19 14:28:56,487 - INFO - Running job: Job 1
2025-12-19 14:28:56,636 - INFO - Job 1 completed successfully
2025-12-19 14:29:01,640 - INFO - Running job: Job 1
2025-12-19 14:29:01,793 - INFO - Job 1 completed successfully
2025-12-19 14:29:06,796 - INFO - Running job: Job 1
2025-12-19 14:29:06,933 - INFO - Job 1 completed successfully
2025-12-19 14:29:11,936 - INFO - Running job: Job 1
2025-12-19 14:29:12,039 - INFO - Job 1 completed successfully
2025-12-19 14:29:17,042 - INFO - Running job: Job 1
2025-12-19 14:29:17,147 - INFO - Job 1 completed successfully
2025-12-19 14:29:22,149 - INFO - Running job: Job 1
2025-12-19 14:29:22,289 - INFO - Job 1 completed successfully
2025-12-19 14:29:27,295 - INFO - Running job: Job 1
2025-12-19 14:29:27,415 - INFO - Job 1 completed successfully
2025-12-19 14:29:32,419 - INFO - Running job: Job 1
2025-12-19 14:29:32,559 - INFO - Job 1 completed successfully
2025-12-19 14:29:37,564 - INFO - Running job: Job 1
2025-12-19 14:29:37,703 - INFO - Job 1 completed successfully
2025-12-19 14:29:42,707 - INFO - Running job: Job 1
2025-12-19 14:29:42,853 - INFO - Job 1 completed successfully
2025-12-19 14:29:47,858 - INFO - Running job: Job 1
2025-12-19 14:29:48,034 - INFO - Job 1 completed successfully
2025-12-19 14:29:53,039 - INFO - Running job: Job 1
2025-12-19 14:29:53,179 - INFO - Job 1 completed successfully
2025-12-19 14:29:58,181 - INFO - Running job: Job 1
2025-12-19 14:29:58,225 - INFO - Job 1 completed successfully
2025-12-19 14:30:03,233 - INFO - Running job: Job 1
2025-12-19 14:30:03,294 - INFO - Job 1 completed successfully
2025-12-19 14:30:08,296 - INFO - Running job: Job 1
2025-12-19 14:30:08,355 - INFO - Job 1 completed successfully
2025-12-19 14:30:13,364 - INFO - Running job: Job 1
2025-12-19 14:30:13,430 - INFO - Job 1 completed successfully
2025-12-19 14:30:18,434 - INFO - Running job: Job 1
2025-12-19 14:30:18,505 - INFO - Job 1 completed successfully
2025-12-19 14:30:23,508 - INFO - Running job: Job 1
2025-12-19 14:30:23,590 - INFO - Job 1 completed successfully
2025-12-19 14:30:28,593 - INFO - Running job: Job 1
2025-12-19 14:30:28,668 - INFO - Job 1 completed successfully
2025-12-19 14:30:33,672 - INFO - Running job: Job 1
2025-12-19 14:30:33,741 - INFO - Job 1 completed successfully
2025-12-19 14:30:38,747 - INFO - Running job: Job 1
2025-12-19 14:30:38,814 - INFO - Job 1 completed successfully
2025-12-19 14:30:43,817 - INFO - Running job: Job 1
2025-12-19 14:30:43,886 - INFO - Job 1 completed successfully
2025-12-19 14:30:48,890 - INFO - Running job: Job 1
2025-12-19 14:30:48,957 - INFO - Job 1 completed successfully
2025-12-19 14:30:53,961 - INFO - Running job: Job 1
2025-12-19 14:30:54,033 - INFO - Job 1 completed successfully
2025-12-19 14:30:59,037 - INFO - Running job: Job 1
2025-12-19 14:30:59,105 - INFO - Job 1 completed successfully
2025-12-19 14:31:04,109 - INFO - Running job: Job 1
2025-12-19 14:31:04,180 - INFO - Job 1 completed successfully
2025-12-19 14:31:09,185 - INFO - Running job: Job 1
2025-12-19 14:31:09,256 - INFO - Job 1 completed successfully
2025-12-19 14:31:14,258 - INFO - Running job: Job 1
2025-12-19 14:31:14,331 - INFO - Job 1 completed successfully
2025-12-19 14:31:19,335 - INFO - Running job: Job 1
2025-12-19 14:31:19,402 - INFO - Job 1 completed successfully
2025-12-19 14:31:24,405 - INFO - Running job: Job 1
2025-12-19 14:31:24,470 - INFO - Job 1 completed successfully
2025-12-19 14:31:29,473 - INFO - Running job: Job 1
2025-12-19 14:31:29,547 - INFO - Job 1 completed successfully
2025-12-19 14:31:34,550 - INFO - Running job: Job 1
2025-12-19 14:31:34,607 - INFO - Job 1 completed successfully
2025-12-19 14:31:39,610 - INFO - Running job: Job 1
2025-12-19 14:31:39,659 - INFO - Job 1 completed successfully
2025-12-19 14:31:44,662 - INFO - Running job: Job 1
2025-12-19 14:31:44,804 - INFO - Job 1 completed successfully
2025-12-19 14:31:49,808 - INFO - Running job: Job 1
2025-12-19 14:31:49,864 - INFO - Job 1 completed successfully
2025-12-19 14:31:51,272 - INFO - Scheduler stopped by user
2025-12-19 14:36:37,287 - INFO - Running job: Job 1
2025-12-19 14:36:37,397 - INFO - Job 1 completed successfully
2025-12-19 14:36:42,399 - INFO - Running job: Job 1
2025-12-19 14:36:42,480 - INFO - Job 1 completed successfully
2025-12-19 14:36:47,483 - INFO - Running job: Job 1
2025-12-19 14:36:47,564 - INFO - Job 1 completed successfully
2025-12-19 14:36:52,567 - INFO - Running job: Job 1
2025-12-19 14:36:52,625 - INFO - Job 1 completed successfully
2025-12-19 14:36:57,629 - INFO - Running job: Job 1
2025-12-19 14:36:57,699 - INFO - Job 1 completed successfully
2025-12-19 14:36:59,049 - INFO - Scheduler stopped by user
2025-12-19 14:49:00,544 - INFO - Running job: Job 1
2025-12-19 14:49:00,609 - INFO - Job 1 completed successfully
